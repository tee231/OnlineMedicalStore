var AjaxPost={ajaxCheckLogin:function(){jQuery.ajax({type:"POST",url:"/index.php?option=com_designevo&task=user.checkState",data:{},success:function(a){var c=a;if(c.csrf_token){jQuery("#token").attr("name",c.csrf_token)}if(c.result==true){loginStatus=true;PanelFunc.closeLoginSignup();jQuery("#preload").hide();if(typeof updateState=="function"){if(c.subscribed){updateState(1)}else{updateState(0)}}if(jQuery("#reset-div").length>0){window.location.href="/"}else{AjaxPost.setUserInfo(c);PanelFunc.hideLoginBtn()}if(jQuery(".promo_page").length>0){try{updatePromotion(c)}catch(b){}}}else{window.loginStatus=false;PanelFunc.showLoginBtn()}}})},loginClick:function(){if(!PopupFunc.validateSignIn()){return}var a=jQuery("div[name='save_progress']")[0];var b=jQuery("button[name='signinSubmit']");if(typeof window.signinText=="undefined"){window.signinText=jQuery("button[name='signinSubmit']")[0].innerHTML}a.style.display="block";b[0].innerHTML="";b.addClass("processing-green-btn");if(window.grecaptcha&&window.grecaptcha.execute&&jQuery("#rcSignInContainer").is(":visible")){if(window.gcSignUpId==undefined){window.gcSignUpId=grecaptcha.render("rcSignUp",{sitekey:"6LeKzqQUAAAAAEJ6PafM6cSZhhN8ghYC0MRvJpyT",callback:AjaxPost.gcAjax})}grecaptcha.execute(window.gcSignUpId)}else{AjaxPost.ajaxLogin(null)}},ajaxLogin:function(c){var e=jQuery("div[name='save_progress']")[0];var f=jQuery("button[name='signinSubmit']");e.style.display="block";f[0].innerHTML="";f.addClass("processing-green-btn");if(!PopupFunc.validateSignIn()){e.style.display="none";f[0].innerHTML=signinText;f.removeClass("processing-green-btn");return}var b=jQuery("input[name='username']")[0];var a=jQuery("input[name='password']")[0];var h=jQuery("#remember").hasClass("designevo-checkbox-btn-checked");var d=jQuery("#token").attr("name");var g={email:b.value,pswd:a.value,remember:h,recaptcha:c};g[d]=1;jQuery.ajax({type:"POST",url:"/index.php?option=com_designevo&task=user.login",data:g,success:function(k){e.style.display="none";f[0].innerHTML=signinText;f.removeClass("processing-green-btn");var m=k;if(m.result==true){loginStatus=true;if(m.csrf_token){jQuery("#token").attr("name",m.csrf_token)}if(jQuery("#reset-div").length>0){window.location.href="/"}else{PanelFunc.closeModal();AjaxPost.setUserInfo(m);PanelFunc.hideLoginBtn()}if(h){CookieFunc.setCookie("designevo_remember",true);CookieFunc.setCookie("designevo_usertoken",m.remembertoken)}else{CookieFunc.delCookie("designevo_remember");CookieFunc.delCookie("designevo_usertoken")}if(jQuery(".promo_page").length>0){try{updatePromotion(m)}catch(l){}}jQuery("#rcSignInContainer").hide()}else{if(m.needCaptcha){jQuery("#rcSignInContainer").show()}else{jQuery("#rcSignInContainer").hide()}if(typeof updateState=="function"){updateState(-1)}a.value="";var o=jQuery("span[name='usernametip']")[0];var j=jQuery("span[name='passwordtip']")[0];o.style.display="none";j.style.display="none";var i=jQuery("span[name='span_signintip']")[0];i.innerHTML=m.error;var n=jQuery("div[name='signintip']")[0];n.style.display="block"}if((typeof grecaptcha!=="undefined")&&grecaptcha){grecaptcha.reset(window.gcSignIn)}},error:function(){var i=jQuery(".designevo-login-tip-append").filter('[data-name="signInTip"]');jQuery(i).show().find("span").html("Login failed, please check your network and try again.");e.style.display="none";f[0].innerHTML=signinText;f.removeClass("processing-green-btn");if((typeof grecaptcha!=="undefined")&&grecaptcha){grecaptcha.reset(window.gcSignIn)}}})},showAlert:function(a){document.getElementById("alert_msg").innerHTML=a;PanelFunc.showModal("alert")},registerClick:function(){gaEvent("signUp","signUp_click");if(!PopupFunc.validateSignUp()){return}var a=jQuery("div[name='save_progress']")[1];var b=jQuery("button[name='signupSubmit']");if(typeof window.signupText=="undefined"){window.signupText=jQuery("button[name='signupSubmit']")[0].innerHTML}a.style.display="block";b[0].innerHTML="";b.addClass("processing-green-btn");if(window.grecaptcha&&grecaptcha.execute){if(window.gcSignUpId==undefined){window.gcSignUpId=grecaptcha.render("rcSignUp",{sitekey:"6LeKzqQUAAAAAEJ6PafM6cSZhhN8ghYC0MRvJpyT",callback:AjaxPost.gcAjax})}grecaptcha.execute(window.gcSignUpId)}else{AjaxPost.ajaxRegister(null)}},gcAjax:function(a){if(jQuery("#signup").is(":visible")){AjaxPost.ajaxRegister(a)}else{if(jQuery("#signin").is(":visible")){AjaxPost.ajaxLogin(a)}}},ajaxRegister:function(c){var f=jQuery("div[name='save_progress']")[1];var h=jQuery("button[name='signupSubmit']");f.style.display="block";h[0].innerHTML="";h.addClass("processing-green-btn");if(!PopupFunc.validateSignUp()){f.style.display="none";h[0].innerHTML=signupText;h.removeClass("processing-green-btn");return}var b=jQuery("input[name='username']")[1];var a=jQuery("input[name='password']")[1];var e=jQuery("#emailService")[0];e.href="http://www."+b.value.substr(b.value.indexOf("@")+1);var d=jQuery("#token").attr("name");var g={email:b.value,pswd:a.value,recaptcha:c};g[d]=1;jQuery.ajax({type:"POST",url:"/index.php?option=com_designevo&task=registration.register",data:g,success:function(k){f.style.display="none";h[0].innerHTML=signupText;h.removeClass("processing-green-btn");var l=k;if(l.csrf_token){jQuery("#token").attr("name",l.csrf_token)}if(l.result==true){loginStatus=true;PanelFunc.closeLoginSignup();jQuery("#preload").hide();AjaxPost.setUserInfo(l);PanelFunc.hideLoginBtn();gaEvent("signUp","signUp_success","signUp_success_mail");if(window.app_survey){window.app_survey.openBox()}else{}if(jQuery("#reset-div").length>0){setTimeout(p(),5000);function p(){window.location.href="/"}}else{var m=document.DesignEvo||window.DesignEvo;if(m&&m.updateUserState){m.updateUserState(k)}if(typeof updateState=="function"){updateState(0)}}if(jQuery(".promo_page").length>0){try{updatePromotion(l)}catch(n){}}}else{var q=jQuery("div[name='signuptip']")[0];var j=jQuery("span[name='usernametip']")[1];var i=jQuery("span[name='passwordtip']")[1];i.style.display="none";switch(l.type){case"email":q.style.display="none";j.innerHTML=l.error;j.style.display="block";break;case"register":j.style.display="none";var o=jQuery("span[name='span_signuptip']")[0];o.innerHTML=l.error;q.style.display="block";break;case"login":PanelFunc.closeLoginSignup();AjaxPost.showAlert(LocalFunc._("registerLoginFailed"));break;default:break}}if((typeof grecaptcha!=="undefined")&&grecaptcha){grecaptcha.reset(window.gcSignUp)}},error:function(){var i=jQuery(".designevo-login-tip-append").filter('[data-name="signUpTip"]');jQuery(i).show().find("span").html(LocalFunc._("registerConnectTip"));f.style.display="none";h[0].innerHTML=signupText;h.removeClass("processing-green-btn");if((typeof grecaptcha!=="undefined")&&grecaptcha){grecaptcha.reset(window.gcSignUp)}}})},ajaxConnectFacebook:function(c,e){var a=0;if(PanelFunc.modalVisible("signup")){a=1}var d=jQuery("button[name='btnFacebook']")[a];var b=jQuery("div[name='fb_progress']")[a];var e=e?e:jQuery(d).html();jQuery(d).html("");jQuery.ajax({type:"POST",url:"/index.php?option=com_designevo&task=registration.connectFacebookUser",data:{token:c},success:function(h){jQuery(b).hide();jQuery(d).html(e);var k=h;if(k.csrf_token){jQuery("#token").attr("name",k.csrf_token)}if(k.result==true){loginStatus=true;if(jQuery("#reset-div").length>0){window.location.href="/"}else{PanelFunc.closeLoginSignup();jQuery("#preload").hide();AjaxPost.setUserInfo(k);PanelFunc.hideLoginBtn()}if(k.register==true){var p=jQuery("#emailService")[0];p.href="http://www."+k.userEmail.substr(k.userEmail.indexOf("@")+1);gaEvent("signUp","signUp_success","signUp_success_facebook");if(window.app_survey){window.app_survey.openBox()}else{}if(jQuery("#reset-div").length>0){setTimeout(o(),5000);function o(){window.location.href="/"}}}if(jQuery(".promo_page").length>0){try{updatePromotion(k)}catch(m){}}}else{var i=jQuery("span[name='usernametip']")[0];var f=jQuery("span[name='passwordtip']")[0];i.style.display="none";f.style.display="none";var l=jQuery("div[name='signuptip']");var g=jQuery("div[name='signintip']");if(g.length==2){var j=jQuery("span[name='span_signintip']")[0];j.innerHTML=k.error;g[0].style.display="block"}else{if(l.length==2){var n=jQuery("span[name='span_signuptip']")[0];n.innerHTML=k.error;l[0].style.display="block"}}}},error:function(){jQuery(b).hide();jQuery(d).html(e);if(a==1){var f=jQuery(".designevo-login-tip-append").filter('[data-name="signInTip"]');jQuery(f).show().find("span").html(LocalFunc._("fbConnectTip"))}else{var f=jQuery(".designevo-login-tip-append").filter('[data-name="signInTip"]');jQuery(f).show().find("span").html(LocalFunc._("fbConnectTip"))}}})},ajaxConnectGoogle:function(d){var a=0;if(PanelFunc.modalVisible("signup")){a=1}var b=jQuery("button[name='btnGoogle']")[a];var c=jQuery("div[name='gl_progress']")[a];jQuery(b).html("");jQuery.ajax({type:"POST",url:"/index.php?option=com_designevo&task=registration.connectGoogleUser",data:{token:d},success:function(h){jQuery(c).hide();jQuery(b).html(loginGoogleFunc.glBtnHtml);var k=h;if(k.csrf_token){jQuery("#token").attr("name",k.csrf_token)}if(k.result==true){loginStatus=true;if(jQuery("#reset-div").length>0){window.location.href="/"}else{PanelFunc.closeLoginSignup();jQuery("#preload").hide();AjaxPost.setUserInfo(k);PanelFunc.hideLoginBtn()}if(k.register==true){gaEvent("signUp","signUp_success","signUp_success_google");var p=jQuery("#emailService")[0];p.href="http://www."+k.userEmail.substr(k.userEmail.indexOf("@")+1);if(window.app_survey){window.app_survey.openBox()}else{}if(jQuery("#reset-div").length>0){setTimeout(o(),5000);function o(){window.location.href="/"}}}if(jQuery(".promo_page").length>0){try{updatePromotion(k)}catch(m){}}}else{var i=jQuery("span[name='usernametip']")[0];var f=jQuery("span[name='passwordtip']")[0];i.style.display="none";f.style.display="none";var l=jQuery("div[name='signuptip']");var g=jQuery("div[name='signintip']");if(g.length==2){var j=jQuery("span[name='span_signintip']")[0];j.innerHTML=k.error;g[0].style.display="block"}else{if(l.length==2){var n=jQuery("span[name='span_signuptip']")[0];n.innerHTML=k.error;l[0].style.display="block"}}}},error:function(){jQuery(c).hide();jQuery(b).html(loginGoogleFunc.glBtnHtml);if(a==1){var e=jQuery(".designevo-login-tip-append").filter('[data-name="signInTip"]');jQuery(e).show().find("span").html(LocalFunc._("glConnectTip"))}else{var e=jQuery(".designevo-login-tip-append").filter('[data-name="signInTip"]');jQuery(e).show().find("span").html(LocalFunc._("glConnectTip"))}}})},ajaxLogout:function(b){stopDefault(b);var a=jQuery("#token").attr("name");var c={};c[a]=1;jQuery.ajax({type:"POST",url:"/index.php?option=com_designevo&task=user.logout",data:c,success:function(e){var d=c;if(d.csrf_token){jQuery("#token").attr("name",d.csrf_token)}if(d.result==false){if(d.error){AjaxPost.showAlert(d.error)}else{AjaxPost.showAlert("Logout failed, please check your network and try again.")}}else{loginStatus=false;if(jQuery("#profile-div").length>0){window.location.href="/"}else{PanelFunc.showLoginBtn();if(window.appLogoutCallback){window.appLogoutCallback("Logout")}}let url=location.href;if(url.indexOf("/apps/logo")>-1){location.href="/logo-maker/"}}},error:function(){AjaxPost.showAlert(LocalFunc._("logoutConnectTip"))}})},setUserInfo:function(a){document.getElementById("user_name").innerHTML=a.userEmail;document.getElementById("imgAvatar").src=document.getElementById("imgAvatarThumb").src=a.img;window.userInfo={img:a.img,userName:a.username,userEmail:a.userEmail};if(window.appLoginCallback){window.appLoginCallback()}if(window.packageLoginCallback){window.packageLoginCallback()}}};AjaxPost.ajaxCheckLogin(true);